<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="website_teachers" name="Teachers">
        <t t-call="website.layout">
            <div class="container py-5">
                <div class="ypu-hero mb-4">
                    <div class="row align-items-center">
                        <div class="col-lg-8">
                            <h1 class="h2 mb-2">Meet Our Staff</h1>
                            <p class="mb-0">Explore profiles by subject, category, and availabilityâ€”no login required.</p>
                        </div>
                        <div class="col-lg-4 text-lg-end mt-3 mt-lg-0">
                            <span class="ypu-badge">Profiles kept up-to-date</span>
                        </div>
                    </div>
                </div>

                <form class="row g-3 mb-4 ypu-filters" method="get" action="/teachers">
                    <div class="col-md-5">
                        <label class="form-label text-muted small mb-1">Search</label>
                        <input type="search" name="search" t-att-value="search" class="form-control"
                               placeholder="Search by name or subject"/>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label text-muted small mb-1">Category</label>
                        <select name="category_id" class="form-select">
                            <option value="">All categories</option>
                            <t t-foreach="categories" t-as="category">
                                <option t-att-value="category['id']"
                                        t-att-selected="True if selected_category == category['id'] else None">
                                    <t t-esc="category['name']"/> (<t t-esc="category['teacher_count'] or 0"/>)
                                </option>
                            </t>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-muted small mb-1">Availability</label>
                        <select name="available" class="form-select">
                            <option value="">Any</option>
                            <option value="1" t-att-selected="True if selected_available is True else None">Available</option>
                            <option value="0" t-att-selected="True if selected_available is False else None">Not available</option>
                        </select>
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button class="btn btn-primary w-100" type="submit">Filter</button>
                    </div>
                </form>

                <t t-if="not teachers">
                    <div class="alert alert-info">
                        No teachers available with the current filters.
                    </div>
                </t>

                <t t-if="teachers">
                    <t t-set="page_arg" t-value="request.httprequest.args.get('page')"/>
                    <t t-set="has_filters"
                       t-value="bool((request.httprequest.args.get('search') or '').strip() or request.httprequest.args.get('category_id') or request.httprequest.args.get('available') or (page_arg and page_arg != '1'))"/>
                    <t t-set="show_featured" t-value="not has_filters"/>

                    <t t-set="dean" t-value="False"/>
                    <t t-foreach="teachers" t-as="t">
                        <t t-if="t.get('is_dean') and not dean" t-set="dean" t-value="t"/>
                    </t>
                    <t t-if="not dean" t-set="dean" t-value="teachers[0]"/>

                    <t t-if="show_featured">
                        <div class="row g-4 mb-4">
                            <div class="col-12">
                                <div t-attf-class="ypu-card h-100 p-3 ypu-card--featured position-relative#{' ypu-card--has-action' if dean.get('show_link_button') and dean.get('link_url') else ''}" style="height: 279px; min-height: 279px; max-height: 279px; overflow: hidden;">

                                    <span t-att-class="'ypu-badge position-absolute top-0 end-0 m-3 ' + ('available' if dean['available'] else 'unavailable')"
                                          style="z-index: 2;">
                                        <t t-esc="'Available' if dean['available'] else 'Unavailable'"/>
                                    </span>

                                    <div class="d-flex" style="height: 100%;">
                                        <div class="ypu-avatar me-3" style="height: 100%; width: 240px; min-width: 240px; max-width: 240px; flex: 0 0 240px; overflow: hidden;">
                                            <t t-if="dean.get('image_1920')">
                                                <img t-att-src="'/web/image/ypu.teacher/%s/image_1920' % dean['id']" alt="Teacher photo" style="width: 100%; height: 100%; object-fit: cover; object-position: top center; display: block;"/>
                                            </t>
                                            <t t-else="">
                                                <t t-esc="(dean['name'] or ' ')[0].upper()"/>
                                            </t>
                                        </div>

                                        <div class="flex-grow-1" style="position: relative; top: -18px;">
                                            <div class="d-flex align-items-start">
                                                <div>
                                                    <h5 class="mb-1"><t t-esc="dean['name']"/></h5>
                                                    <div class="text-muted small">
                                                        <t t-esc="dean.get('subject') or ''"/>
                                                    </div>
                                                    <div class="text-muted small">
                                                        <t t-if="dean['department']"><t t-esc="dean['department']"/></t>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="mt-2">
                                                <t t-if="dean['category_id']">
                                                    <span class="ypu-tag">
                                                        <t t-esc="dean['category_id'][1]"/>
                                                    </span>
                                                </t>
                                                <t t-if="dean.get('subject')">
                                                    <span class="ypu-tag">
                                                        <t t-esc="dean['subject']"/>
                                                    </span>
                                                </t>
                                                <t t-if="dean['position_id']">
                                                    <span class="ypu-tag">
                                                        <t t-esc="dean['position_id'][1]"/>
                                                    </span>
                                                </t>
                                            </div>

                                            <div class="small mt-3 d-flex justify-content-center">
                                                <div class="text-start"
                                                     style="display:inline-grid;
                                                            grid-template-columns: max-content auto;
                                                            column-gap: 6px;
                                                            row-gap: 3px;
                                                            align-items: baseline;
                                                            line-height: 1.2;
                                                            padding-left: 24px;">
                                                    <span class="text-muted fw-semibold" style="white-space: nowrap;">Email</span>
                                                    <span class="text-break"><t t-esc="dean.get('email') or '-'"/></span>

                                                    <span class="text-muted fw-semibold" style="white-space: nowrap;">Phone</span>
                                                    <span class="text-break"><t t-esc="dean.get('phone') or '-'"/></span>

                                                    <span class="text-muted fw-semibold" style="white-space: nowrap;">LinkedIn</span>
                                                    <span class="text-break"><t t-esc="dean.get('years_of_experience') or 0"/></span>

                                                    <span class="text-muted fw-semibold" style="white-space: nowrap;">Research Gate</span>
                                                    <span class="text-break"><t t-esc="dean.get('research_gate') or '-'"/></span>

                                                </div>
                                            </div>
                                            <t t-if="dean.get('show_link_button') and dean.get('link_url')">
                                                <div class="ypu-card-action">
                                                    <a class="btn btn-primary" t-att-href="dean.get('link_url')">Visit Link</a>
                                                </div>
                                            </t>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </t>

                    <div class="row row-cols-1 row-cols-md-2 g-4">
                        <t t-foreach="teachers" t-as="teacher">
                            <t t-if="(not show_featured) or (teacher['id'] != dean['id'])">
                                <div class="col">
                                    <div t-attf-class="ypu-card h-100 p-3#{' ypu-card--has-action' if teacher.get('show_link_button') and teacher.get('link_url') else ''}">
                                        <div class="d-flex">
                                            <div class="ypu-avatar me-3">
                                                <t t-if="teacher.get('image_1920')">
                                                    <img t-att-src="'/web/image/ypu.teacher/%s/image_1920' % teacher['id']" alt="Teacher photo"/>
                                                </t>
                                                <t t-else="">
                                                    <t t-esc="(teacher['name'] or ' ')[0].upper()"/>
                                                </t>
                                            </div>

                                            <div class="flex-grow-1">
                                                <div class="d-flex justify-content-between align-items-start">
                                                    <div>
                                                        <h5 class="mb-1"><t t-esc="teacher['name']"/></h5>
                                                        <div class="text-muted small">
                                                            <t t-esc="teacher.get('subject') or ''"/>
                                                        </div>
                                                        <div class="text-muted small">
                                                            <t t-if="teacher['department']"><t t-esc="teacher['department']"/></t>
                                                        </div>
                                                    </div>
                                                    <span class="ypu-badge" t-att-class="'ypu-badge ' + ('available' if teacher['available'] else 'unavailable')">
                                                        <t t-esc="'Available' if teacher['available'] else 'Unavailable'"/>
                                                    </span>
                                                </div>
                                                <div class="mt-2">
                                                    <t t-if="teacher['category_id']">
                                                        <span class="ypu-tag">
                                                            <t t-esc="teacher['category_id'][1]"/>
                                                        </span>
                                                    </t>
                                                    <t t-if="teacher.get('subject')">
                                                        <span class="ypu-tag">
                                                            <t t-esc="teacher['subject']"/>
                                                        </span>
                                                    </t>
                                                    <t t-if="dean['position_id']">
                                                    <span class="ypu-tag">
                                                        <t t-esc="dean['position_id'][1]"/>
                                                    </span>
                                                </t>

                                                </div>
                                            </div>
                                        </div>

                                        <dl class="row mb-0 ypu-meta small mt-3">
                                            <dt class="col-4">Email</dt>
                                            <dd class="col-8">
                                                <t t-esc="teacher.get('email') or '-'"/>
                                            </dd>

                                            <dt class="col-4">Phone</dt>
                                            <dd class="col-8">
                                                <t t-esc="teacher.get('phone') or '-'"/>
                                            </dd>

                                            <dt class="col-4">LinkedIn</dt>
                                            <dd class="col-8">
                                                <t t-esc="teacher.get('years_of_experience') or 0"/>
                                            </dd>
                                            <dt class="col-4">Research Gate</dt>
                                            <dd class="col-8">
                                                <t t-esc="teacher.get('research_gate') or '-'"/>
                                            </dd>

                                        </dl>
                                        <t t-if="teacher.get('show_link_button') and teacher.get('link_url')">
                                            <div class="ypu-card-action">
                                                <a class="btn btn-primary btn-sm" t-att-href="teacher.get('link_url')">Visit Link</a>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </t>
                        </t>
                    </div>
                </t>

            </div>
        </t>
    </template>
</odoo>
